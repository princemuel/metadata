---
import { formatCanonicalURL } from "@/helpers/seo";
import { defaultKeywords, delimiter } from "@/lib/config";
import "@/styles/main.css";
// import { pwaAssetsHead } from "virtual:pwa-assets/head";

type Props = Meta & { og?: OpenGraph; twitter?: Twitter };

const { title, description, image, tags, canonical, publishedAt, updatedAt } =
  Astro.props;

const og = {
  type: "website",
  ...Astro.props.og,
} satisfies OpenGraph;

const twitter = {
  handle: "@iamprincemuel",
  card: "summary_large_image",
  ...Astro.props.twitter,
} satisfies Twitter;

const name = "Prince Muel";
const siteUrl = import.meta.env.PUBLIC_SITE_URL;
const defaultImage = "static/assets/princemuel-open-graph-image-2024.jpg";
const locale = "en";

const htmlTitle = `${name} ${delimiter} ${title}`;
const linkCanonical = formatCanonicalURL(
  canonical || new URL(Astro.url.pathname, Astro.site),
);
const ogImage = image
  ? image
  : { src: `${siteUrl}/${defaultImage}`, alt: description };
const seoKeywords = tags ? tags : defaultKeywords;
const application_name = `${name}'s Personal Website`;
---

<title>{htmlTitle}</title>

<meta name="generator" content={Astro.generator} />
<meta name="application-name" content={application_name} />
<meta name="referrer" content="origin-when-cross-origin" />
<meta name="color-scheme" content="dark light" />
<!-- {
  pwaAssetsHead.themeColor && (
    <meta name="theme-color" content={pwaAssetsHead.themeColor.content} />
  )
} -->

<meta name="robots" content="index, follow" />
<meta
  name="googlebot"
  content="index, follow, max-snippet:160, max-image-preview:large, max-video-preview:-1"
/>

<meta name="description" content={description} />
<meta name="image" content={ogImage.src} />
<meta name="image:alt" content={ogImage.alt} />
<meta name="keywords" content={seoKeywords.join(", ")} />

<meta name="creator" content={name} />
<meta name="publisher" content={name} />
<meta name="author" content={name} />
<link rel="author" href="https://github.com/princemuel" />
<link rel="canonical" href={linkCanonical} />
{
  og.type === "article" && (
    <>
      <meta property="article:published_time" content={publishedAt} />
      <meta property="article:modified_time" content={updatedAt} />
    </>
  )
}

<!-- Facebook -->
<meta property="og:type" content={og.type} />
<meta property="og:locale" content={locale} />
<meta property="og:site_name" content={application_name} />
<meta property="og:title" content={htmlTitle} />
<meta property="og:url" content={linkCanonical} />
<meta property="og:description" content={description} />
<meta property="og:image" content={ogImage.src} />
<meta property="og:image:alt" content={ogImage.alt} />

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content={twitter.handle} />
<meta name="twitter:title" content={htmlTitle} />
<meta name="twitter:url" content={linkCanonical} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={ogImage.src} />
<meta name="twitter:image:alt" content={ogImage.alt} />

<!-- Favicons -->
<!-- {pwaAssetsHead.links.map((link) => <link {...link} />)} -->

<link rel="sitemap" type="application/xml" href="/sitemap-index.xml" />
<link
  rel="alternate"
  type="application/rss+xml"
  title={`${name} ${delimiter} Blog RSS Feed`}
  href="/rss.xml"
/>

<meta name="format-detection" content="telephone=no, address=no, email=no" />
<meta name="google-site-verification" content="google" />
<meta name="y_key" content="yahoo" />
<meta name="yandex-verification" content="yandex" />
<meta name="bing" content="msvalidate.01=0" />
<meta name="me" content="vansomecsam@gmail.com" />
<meta name="me" content="my-link" />
